<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Тест на множинні інтелекти – за моделлю множинного інтелекту Говарда Гарднера</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen,
        Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
      max-width: 700px;
      margin: 40px auto;
      padding: 20px;
      line-height: 1.5;
      background-color: #f2f2f7;
      color: #1c1c1e;
    }
    #name-prompt, #quiz-container, #result-modal {
      background: white;
      border-radius: 15px;
      box-shadow: 0 3px 6px rgba(0,0,0,0.1);
      padding: 30px;
      box-sizing: border-box;
    }
    #name-prompt input, #name-prompt select {
      font-size: 18px;
      padding: 12px 15px;
      border-radius: 10px;
      border: 1px solid #ccc;
      width: 100%;
      box-sizing: border-box;
      margin-top: 8px;
      margin-bottom: 20px;
      outline-offset: 2px;
      transition: border-color 0.2s;
    }
    #name-prompt input:focus, #name-prompt select:focus {
      border-color: #007aff;
      outline: none;
    }
    #start-btn, #export-btn {
      background-color: #007aff;
      color: white;
      font-size: 20px;
      padding: 15px;
      width: 100%;
      border: none;
      border-radius: 15px;
      cursor: pointer;
      transition: background-color 0.25s;
      user-select: none;
    }
    #start-btn:hover, #export-btn:hover {
      background-color: #005bb5;
    }
    .question {
      font-size: 22px;
      font-weight: 600;
      margin-bottom: 20px;
    }
    .options button {
      display: block;
      width: 100%;
      margin: 10px 0;
      padding: 15px;
      font-size: 18px;
      cursor: pointer;
      text-align: left;
      border: 1px solid #ccc;
      border-radius: 12px;
      background-color: white;
      transition: background-color 0.25s, border-color 0.25s;
      user-select: none;
    }
    .options button:hover {
      background-color: #e0e0e5;
      border-color: #007aff;
    }
    #timer {
      font-size: 18px;
      font-weight: 600;
      color: #007aff;
      margin-bottom: 15px;
      text-align: right;
      user-select: none;
    }
    #timer.warning {
      color: #ff3b30;
    }
    #result-modal {
      max-width: 600px;
      margin: 0 auto;
      text-align: center;
      display: none;
      position: relative;
    }
    #result-text {
      white-space: pre-wrap;
      font-size: 18px;
      margin-bottom: 25px;
      text-align: left;
    }
    #overlay {
      position: fixed;
      top:0; left:0; right:0; bottom:0;
      background: rgba(0,0,0,0.3);
      display: none;
      z-index: 100;
    }
    canvas {
      max-width: 100%;
      margin-bottom: 20px;
      border-radius: 15px;
      box-shadow: 0 3px 6px rgba(0,0,0,0.1);
    }
  </style>
</head>
<body>

  <div id="name-prompt">
    <h2>Введіть ваше ім’я, щоб розпочати тест</h2>
    <input type="text" id="username" placeholder="Ваше ім’я" />
    <h3>Введіть ваш вік</h3>
    <input type="number" id="userage" placeholder="Ваш вік" min="1" max="120" />
    <h3>Оберіть стать</h3>
    <select id="usersex">
      <option value="masc">Чоловіча</option>
      <option value="fem">Жіноча</option>
    </select>
    <button id="start-btn">Почати тест</button>
  </div>

  <div id="quiz-container" style="display:none;">
    <div id="timer">Час: 30 с</div>
    <div id="question-number"></div>
    <div id="question-text" class="question"></div>
    <div class="options" id="options-container"></div>
  </div>

  <div id="overlay"></div>

  <div id="result-modal">
    <div id="result-text"></div>
    <canvas id="result-chart"></canvas>
    <button id="export-btn">Експортувати результати у PDF</button>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <script>
    const questions = [
      {id:1, textMasc:"Мені подобається дізнаватися більше про себе", textFem:"Мені подобається дізнаватися більше про себе"},
      {id:2, textMasc:"Я вмію грати на музичному інструменті", textFem:"Я вмію грати на музичному інструменті"},
      {id:3, textMasc:"Найлегше вирішую проблеми, коли займаюся чимось фізичним", textFem:"Найлегше вирішую проблеми, коли займаюся чимось фізичним"},
      {id:4, textMasc:"У мене часто в голові звучить пісня або музичний твір", textFem:"У мене часто в голові звучить пісня або музичний твір"},
      {id:5, textMasc:"Мені легко планувати бюджет і керувати грошима", textFem:"Мені легко планувати бюджет і керувати грошима"},
      {id:6, textMasc:"Мені легко вигадувати історії", textFem:"Мені легко вигадувати історії"},
      {id:7, textMasc:"Я завжди мав/мала хорошу координацію", textFem:"Я завжди мала хорошу координацію"},
      {id:8, textMasc:"Розмовляючи з кимось, я звертаю увагу не лише на сенс, а й на слова, які використовуються", textFem:"Розмовляючи з кимось, я звертаю увагу не лише на сенс, а й на слова, які використовуються"},
      {id:9, textMasc:"Я люблю кросворди, пошук слів або інші словесні головоломки", textFem:"Я люблю кросворди, пошук слів або інші словесні головоломки"},
      {id:10, textMasc:"Я не люблю неоднозначність, мені подобається ясність", textFem:"Я не люблю неоднозначність, мені подобається ясність"},
      {id:11, textMasc:"Мені подобаються логічні головоломки, наприклад судоку", textFem:"Мені подобаються логічні головоломки, наприклад судоку"},
      {id:12, textMasc:"Я люблю медитувати", textFem:"Я люблю медитувати"},
      {id:13, textMasc:"Музика дуже важлива для мене", textFem:"Музика дуже важлива для мене"},
      {id:14, textMasc:"Я переконливий/переконлива брехун/брехунка", textFem:"Я переконлива брехунка"},
      {id:15, textMasc:"Я займаюся спортом або танцями", textFem:"Я займаюся спортом або танцями"},
      {id:16, textMasc:"Мене дуже цікавлять психометричні тести (тести особистості) та тести IQ", textFem:"Мене дуже цікавлять психометричні тести (тести особистості) та тести IQ"},
      {id:17, textMasc:"Мене дратують люди, які поводяться нераціонально", textFem:"Мене дратують люди, які поводяться нераціонально"},
      {id:18, textMasc:"Музика, яка мені подобається, часто відповідає моєму емоційному стану", textFem:"Музика, яка мені подобається, часто відповідає моєму емоційному стану"},
      {id:19, textMasc:"Я дуже товариська людина і люблю бути серед людей", textFem:"Я дуже товариська людина і люблю бути серед людей"},
      {id:20, textMasc:"Я люблю діяти системно та ретельно", textFem:"Я люблю діяти системно та ретельно"},
      {id:21, textMasc:"Мені легко розуміти графіки та діаграми", textFem:"Мені легко розуміти графіки та діаграми"},
      {id:22, textMasc:"Я добре кидаю речі — дротики, камінці, фрізбі тощо", textFem:"Я добре кидаю речі — дротики, камінці, фрізбі тощо"},
      {id:23, textMasc:"Мені легко запам’ятовувати цитати чи фрази", textFem:"Мені легко запам’ятовувати цитати чи фрази"},
      {id:24, textMasc:"Я завжди впізнаю місця, де вже бував/була, навіть у дитинстві", textFem:"Я завжди впізнаю місця, де вже була, навіть у дитинстві"},
      {id:25, textMasc:"Мені подобаються різні музичні стилі", textFem:"Мені подобаються різні музичні стилі"},
      {id:26, textMasc:"Коли я зосереджений/зосереджена, я часто щось малюю або креслю", textFem:"Коли я зосереджена, я часто щось малюю або креслю"},
      {id:27, textMasc:"Я міг/могла б маніпулювати людьми, якби захотів/захотіла", textFem:"Я могла б маніпулювати людьми, якби захотіла"},
      {id:28, textMasc:"Я можу досить точно передбачити свої почуття та поведінку в певних ситуаціях", textFem:"Я можу досить точно передбачити свої почуття та поведінку в певних ситуаціях"},
      {id:29, textMasc:"Мені легко робити усні обчислення", textFem:"Мені легко робити усні обчислення"},
      {id:30, textMasc:"Я можу розпізнавати більшість звуків, не бачачи їх джерела", textFem:"Я можу розпізнавати більшість звуків, не бачачи їх джерела"},
      {id:31, textMasc:"У школі одним із моїх улюблених предметів була англійська мова", textFem:"У школі одним із моїх улюблених предметів була англійська мова"},
      {id:32, textMasc:"Мені подобається обдумувати проблему, зважуючи всі наслідки", textFem:"Мені подобається обдумувати проблему, зважуючи всі наслідки"},
      {id:33, textMasc:"Я люблю дебати та обговорення", textFem:"Я люблю дебати та обговорення"},
      {id:34, textMasc:"Я люблю екстремальні види спорту та страшні атракціони", textFem:"Я люблю екстремальні види спорту та страшні атракціони"},
      {id:35, textMasc:"Мені більше подобаються індивідуальні види спорту", textFem:"Мені більше подобаються індивідуальні види спорту"},
      {id:36, textMasc:"Мені не байдуже, як почуваються люди навколо мене", textFem:"Мені не байдуже, як почуваються люди навколо мене"},
      {id:37, textMasc:"Мій дім повен фотографій та картин", textFem:"Мій дім повен фотографій та картин"},
      {id:38, textMasc:"Я люблю щось майструвати — у мене вправні руки", textFem:"Я люблю щось майструвати — у мене вправні руки"},
      {id:39, textMasc:"Мені подобається, коли музика звучить у фоновому режимі", textFem:"Мені подобається, коли музика звучить у фоновому режимі"},
      {id:40, textMasc:"Я легко запам’ятовую телефонні номери", textFem:"Я легко запам’ятовую телефонні номери"},
      {id:41, textMasc:"Я ставлю собі цілі та плани на майбутнє", textFem:"Я ставлю собі цілі та плани на майбутнє"},
      {id:42, textMasc:"Я дуже тактильна людина", textFem:"Я дуже тактильна людина"},
      {id:43, textMasc:"Я легко розумію, чи подобаюсь я комусь чи ні", textFem:"Я легко розумію, чи подобаюсь я комусь чи ні"},
      {id:44, textMasc:"Я легко уявляю, як виглядає об’єкт з іншої точки зору", textFem:"Я легко уявляю, як виглядає об’єкт з іншої точки зору"},
      {id:45, textMasc:"Я ніколи не використовую інструкції для збирання меблів", textFem:"Я ніколи не використовую інструкції для збирання меблів"},
      {id:46, textMasc:"Мені легко спілкуватися з новими людьми", textFem:"Мені легко спілкуватися з новими людьми"},
      {id:47, textMasc:"Щоб навчитися чомусь новому, мені потрібно просто почати це робити", textFem:"Щоб навчитися чомусь новому, мені потрібно просто почати це робити"},
      {id:48, textMasc:"Я часто бачу чіткі образи, коли заплющую очі", textFem:"Я часто бачу чіткі образи, коли заплющую очі"},
      {id:49, textMasc:"Я не використовую пальці, коли рахую", textFem:"Я не використовую пальці, коли рахую"},
      {id:50, textMasc:"Я часто розмовляю сам/сама з собою — вголос або подумки", textFem:"Я часто розмовляю сама з собою — вголос або подумки"},
      {id:51, textMasc:"У школі мені подобалися уроки музики", textFem:"У школі мені подобалися уроки музики"},
      {id:52, textMasc:"За кордоном мені легко даються основи нової мови", textFem:"За кордоном мені легко даються основи нової мови"},
      {id:53, textMasc:"Я люблю й мені легко даються ігри з м’ячем", textFem:"Я люблю й мені легко даються ігри з м’ячем"},
      {id:54, textMasc:"Мій улюблений шкільний предмет — математика", textFem:"Мій улюблений шкільний предмет — математика"},
      {id:55, textMasc:"Я завжди знаю, як себе почуваю", textFem:"Я завжди знаю, як себе почуваю"},
      {id:56, textMasc:"Я реалістично оцінюю свої сильні та слабкі сторони", textFem:"Я реалістично оцінюю свої сильні та слабкі сторони"},
      {id:57, textMasc:"Я веду щоденник", textFem:"Я веду щоденник"},
      {id:58, textMasc:"Я дуже уважний/уважна до мови тіла інших людей", textFem:"Я дуже уважна до мови тіла інших людей"},
      {id:59, textMasc:"Мій улюблений предмет у школі — мистецтво", textFem:"Мій улюблений предмет у школі — мистецтво"},
      {id:60, textMasc:"Я отримую задоволення від читання", textFem:"Я отримую задоволення від читання"},
      {id:61, textMasc:"Я легко читаю карти", textFem:"Я легко читаю карти"},
      {id:62, textMasc:"Мені боляче бачити, як хтось плаче, і не мати змоги допомогти", textFem:"Мені боляче бачити, як хтось плаче, і не мати змоги допомогти"},
      {id:63, textMasc:"Я добре вирішую конфлікти між іншими", textFem:"Я добре вирішую конфлікти між іншими"},
      {id:64, textMasc:"Я завжди мріяв/мріяла стати актором/акторкою", textFem:"Я завжди мріяла стати акторкою"},
      {id:65, textMasc:"У мене гарна пам’ять на обличчя", textFem:"У мене гарна пам’ять на обличчя"},
      {id:66, textMasc:"Я часто думаю про свої почуття", textFem:"Я часто думаю про свої почуття"},
      {id:67, textMasc:"Я люблю робити щось своїми руками", textFem:"Я люблю робити щось своїми руками"},
      {id:68, textMasc:"Я люблю, коли навколо чисто і організовано", textFem:"Я люблю, коли навколо чисто і організовано"},
      {id:69, textMasc:"Мені подобається складати вірші або тексти пісень", textFem:"Мені подобається складати вірші або тексти пісень"},
      {id:70, textMasc:"Я уважний/уважна до деталей", textFem:"Я уважна до деталей"},
    ];

    // Категорії інтелекту для кожного питання (id => категорія)
    // (тут приклад, треба ваші реальні категорії)
    const categories = {
      1: "intrapersonal",
      2: "musical",
      3: "bodilyKinesthetic",
      4: "musical",
      5: "logicalMathematical",
      6: "linguistic",
      7: "bodilyKinesthetic",
      8: "linguistic",
      9: "linguistic",
      10: "logicalMathematical",
      11: "logicalMathematical",
      12: "intrapersonal",
      13: "musical",
      14: "interpersonal",
      15: "bodilyKinesthetic",
      16: "intrapersonal",
      17: "logicalMathematical",
      18: "musical",
      19: "interpersonal",
      20: "logicalMathematical",
      21: "visualSpatial",
      22: "bodilyKinesthetic",
      23: "linguistic",
      24: "visualSpatial",
      25: "musical",
      26: "visualSpatial",
      27: "interpersonal",
      28: "intrapersonal",
      29: "logicalMathematical",
      30: "musical",
      31: "linguistic",
      32: "logicalMathematical",
      33: "linguistic",
      34: "bodilyKinesthetic",
      35: "bodilyKinesthetic",
      36: "interpersonal",
      37: "visualSpatial",
      38: "bodilyKinesthetic",
      39: "musical",
      40: "linguistic",
      41: "intrapersonal",
      42: "bodilyKinesthetic",
      43: "interpersonal",
      44: "visualSpatial",
      45: "bodilyKinesthetic",
      46: "interpersonal",
      47: "bodilyKinesthetic",
      48: "visualSpatial",
      49: "logicalMathematical",
      50: "intrapersonal",
      51: "musical",
      52: "linguistic",
      53: "bodilyKinesthetic",
      54: "logicalMathematical",
      55: "intrapersonal",
      56: "intrapersonal",
      57: "intrapersonal",
      58: "interpersonal",
      59: "visualSpatial",
      60: "linguistic",
      61: "visualSpatial",
      62: "interpersonal",
      63: "interpersonal",
      64: "bodilyKinesthetic",
      65: "visualSpatial",
      66: "intrapersonal",
      67: "bodilyKinesthetic",
      68: "bodilyKinesthetic",
      69: "linguistic",
      70: "visualSpatial"
    };

    const selectedQuestionsForUnder16 = [2, 4, 6, 7, 13, 14, 15, 19, 21, 23, 24, 26, 29, 31, 32, 34, 35, 40, 41, 43, 47, 48, 49, 51, 53, 54, 55, 57, 59, 60, 62, 65, 66, 69, 70];

    let filteredQuestions = questions; // будуть фільтровані питання
    let currentQuestionIndex = 0;
    let scores = {};
    let userage = 0;
    let username = "";
    let usersex = "masc";
    let timerInterval;
    let timeLeft = 30;

    const namePromptDiv = document.getElementById("name-prompt");
    const quizContainer = document.getElementById("quiz-container");
    const questionText = document.getElementById("question-text");
    const optionsContainer = document.getElementById("options-container");
    const questionNumberDiv = document.getElementById("question-number");
    const timerDiv = document.getElementById("timer");
    const startBtn = document.getElementById("start-btn");
    const resultModal = document.getElementById("result-modal");
    const resultText = document.getElementById("result-text");
    const resultChart = document.getElementById("result-chart");
    const exportBtn = document.getElementById("export-btn");
    const overlay = document.getElementById("overlay");

    startBtn.addEventListener("click", () => {
      username = document.getElementById("username").value.trim();
      userage = parseInt(document.getElementById("userage").value);
      usersex = document.getElementById("usersex").value;

      if (!username) {
        alert("Будь ласка, введіть ім’я.");
        return;
      }
      if (!userage || userage < 1 || userage > 120) {
        alert("Будь ласка, введіть коректний вік.");
        return;
      }

      // Фільтрація питань за віком
      if (userage < 16) {
        filteredQuestions = questions.filter(q => selectedQuestionsForUnder16.includes(q.id));
      } else {
        filteredQuestions = questions;
      }

      // Ініціалізація результатів
      scores = {};
      Object.values(categories).forEach(cat => scores[cat] = 0);

      currentQuestionIndex = 0;
      namePromptDiv.style.display = "none";
      quizContainer.style.display = "block";
      resultModal.style.display = "none";
      overlay.style.display = "none";

      startTimer();
      showQuestion();
    });

    function startTimer() {
      clearInterval(timerInterval);
      timeLeft = 30;
      updateTimerDisplay();
      timerInterval = setInterval(() => {
        timeLeft--;
        updateTimerDisplay();
        if (timeLeft <= 0) {
          clearInterval(timerInterval);
          // Якщо час вичерпано, рахувати 1 бал по категорії поточного питання
          answerQuestion(1);
        }
      }, 1000);
    }

    function updateTimerDisplay() {
      timerDiv.textContent = `Час: ${timeLeft} с`;
      if (timeLeft <= 5) {
        timerDiv.classList.add("warning");
      } else {
        timerDiv.classList.remove("warning");
      }
    }

    function showQuestion() {
      if (currentQuestionIndex >= filteredQuestions.length) {
        clearInterval(timerInterval);
        return showResults();
      }

      const q = filteredQuestions[currentQuestionIndex];
      questionNumberDiv.textContent = `Питання ${currentQuestionIndex + 1} з ${filteredQuestions.length}`;
      questionText.textContent = usersex === "masc" ? q.textMasc : q.textFem;

      optionsContainer.innerHTML = "";

      // Відповіді — 4 варіанти, бали від 1 до 4
      for (let i = 1; i <= 4; i++) {
        const btn = document.createElement("button");
        btn.textContent = `${i}`;
        btn.dataset.score = i;
        btn.addEventListener("click", () => answerQuestion(i));
        optionsContainer.appendChild(btn);
      }
    }

    function answerQuestion(score) {
      const q = filteredQuestions[currentQuestionIndex];
      clearInterval(timerInterval);
      // Додаємо бал до категорії питання
      const cat = categories[q.id];
      if (cat) {
        scores[cat] += score;
      }

      currentQuestionIndex++;
      startTimer();
      showQuestion();
    }

    function showResults() {
      quizContainer.style.display = "none";
      resultModal.style.display = "block";
      overlay.style.display = "block";

      // Сортуємо категорії за результатом
      const sortedScores = Object.entries(scores)
        .sort((a,b) => b[1] - a[1]);

      let resultStr = `Дякуємо, ${username}! Ось ваші результати тесту:\n\n`;

      sortedScores.forEach(([cat, score]) => {
        let label = "";
        switch(cat) {
          case "linguistic": label = "Лінгвістичний інтелект"; break;
          case "logicalMathematical": label = "Логіко-математичний інтелект"; break;
          case "musical": label = "Музичний інтелект"; break;
          case "bodilyKinesthetic": label = "Кінестетичний (тілесний) інтелект"; break;
          case "visualSpatial": label = "Візуально-просторовий інтелект"; break;
          case "interpersonal": label = "Міжособистісний інтелект"; break;
          case "intrapersonal": label = "Внутрішньоособистісний інтелект"; break;
          default: label = cat; break;
        }
        resultStr += `${label}: ${score} балів\n`;
      });

      resultText.textContent = resultStr;

      drawChart(sortedScores);

      exportBtn.onclick = () => exportPDF(resultStr);
    }

    function drawChart(sortedScores) {
      if (window.myChart) {
        window.myChart.destroy();
      }

      const labels = sortedScores.map(([cat]) => {
        switch(cat) {
          case "linguistic": return "Лінгвістичний";
          case "logicalMathematical": return "Логіко-математичний";
          case "musical": return "Музичний";
          case "bodilyKinesthetic": return "Кінестетичний";
          case "visualSpatial": return "Візуально-просторовий";
          case "interpersonal": return "Міжособистісний";
          case "intrapersonal": return "Внутрішньоособистісний";
          default: return cat;
        }
      });

      const data = sortedScores.map(([,score]) => score);

      const ctx = resultChart.getContext('2d');
      window.myChart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels,
          datasets: [{
            label: 'Бали за категоріями',
            data,
            backgroundColor: '#007aff'
          }]
        },
        options: {
          responsive: true,
          scales: {
            y: { beginAtZero: true }
          },
          plugins: {
            legend: { display: false }
          }
        }
      });
    }

    function exportPDF(resultStr) {
      const { jsPDF } = window.jspdf;
      const pdf = new jsPDF();

      pdf.setFontSize(18);
      pdf.text(`Результати тесту для ${username}`, 10, 20);
      pdf.setFontSize(14);
      pdf.text(resultStr, 10, 30);

      // Додамо діаграму як зображення
      const canvas = document.getElementById('result-chart');
      const imgData = canvas.toDataURL("image/png");

      pdf.addImage(imgData, 'PNG', 10, 60, 180, 80);

      pdf.save(`Результати_тесту_${username}.pdf`);
    }

    // Закриваємо результат при кліку на overlay
    overlay.addEventListener("click", () => {
      resultModal.style.display = "none";
      overlay.style.display = "none";
      namePromptDiv.style.display = "block";
    });
  </script>
</body>
</html>
